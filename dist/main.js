(()=>{"use strict";const e="https://bytegrad.com/course-assets/js/2/api",t={searchJobItems:[],bookmarkJobItems:[],activeJobItem:{},currentPage:1},o=document.querySelector(".bookmarks-btn"),s=document.querySelector(".error__text"),a=document.querySelector(".job-details__content"),i=document.querySelector(".job-details"),n=document.querySelector(".job-list--bookmarks"),c=document.querySelector(".job-list--search"),r=document.querySelector(".count__number"),l=document.querySelector(".pagination"),b=document.querySelector(".pagination__button--next"),d=document.querySelector(".pagination__button--back"),m=document.querySelector(".error"),_=document.querySelector(".pagination__number--next"),u=(document.querySelector(".pagination__number--back"),document.querySelector(".search")),v=document.querySelector(".search__input"),k=document.querySelector(".sorting"),f=document.querySelector(".sorting__button--relevant"),g=document.querySelector(".sorting__button--recent"),p=document.querySelector(".spinner--search"),j=document.querySelector(".spinner--job-details"),h=async e=>{const t=await fetch(e),o=await t.json();if(!t.ok)throw new Error(o.description);return o},y=e=>{("search"===e?p:j).classList.toggle("spinner--visible")},L=e=>{const o=`\n             <img src="${e.coverImgURL}" alt="#" class="job-details__cover-img">\n\n             <a class="apply-btn" href="${e.companyURL}" target="_blank">Apply <i class="fa-solid fa-square-arrow-up-right apply-btn__icon"></i></a>\n\n             <section class="job-info">\n                 <div class="job-info__left">\n                     <div class="job-info__badge">${e.badgeLetters}</div>\n                     <div class="job-info__below-badge">\n                         <time class="job-info__time">${e.daysAgo}d</time>\n                         <button class="job-info__bookmark-btn">\n                             <i class="fa-solid fa-bookmark job-info__bookmark-icon ${t.bookmarkJobItems.some((t=>t.id===e.id))&&"job-info__bookmark-icon--bookmarked"}"></i>\n                         </button>\n                     </div>\n                 </div>\n                 <div class="job-info__right">\n                     <h2 class="second-heading">${e.title}</h2>\n                     <p class="job-info__company">${e.company}</p>\n                     <p class="job-info__description">${e.description}</p>\n                     <div class="job-info__extras">\n                         <p class="job-info__extra"><i class="fa-solid fa-clock job-info__extra-icon"></i> ${e.duration}</p>\n                         <p class="job-info__extra"><i class="fa-solid fa-money-bill job-info__extra-icon"></i> ${e.salary}</p>\n                         <p class="job-info__extra"><i class="fa-solid fa-location-dot job-info__extra-icon"></i> ${e.location}</p>\n                     </div>\n                 </div>\n             </section>\n\n             <div class="job-details__other">\n                 <section class="qualifications">\n                     <div class="qualifications__left">\n                         <h4 class="fourth-heading">Qualifications</h4>\n                         <p class="qualifications__sub-text">Other qualifications may apply</p>\n                     </div>\n                     <ul class="qualifications__list">\n                         ${e.qualifications.map((e=>`<li class="qualifications__item">${e}</li>`)).join("")}\n                     </ul>\n                 </section>\n                 \n                 <section class="reviews">\n                     <div class="reviews__left">\n                         <h4 class="fourth-heading">Company reviews</h4>\n                         <p class="reviews__sub-text">Recent things people are saying</p>\n                     </div>\n                     <ul class="reviews__list">\n                         ${e.reviews.map((e=>`<li class="reviews__item">${e}</li>`)).join("")}\n                     </ul>\n                 </section>\n             </div>\n\n             <footer class="job-details__footer">\n                 <p class="job-details__footer-text">If possible, please reference that you found the job on <span class="u-bold">rmtDev</span>, we would really appreciate it!</p>\n             </footer>\n         `;a.innerHTML=o},I=(e="Add an arguement to renderError")=>{s.textContent=e,m.classList.add("error--visible"),setTimeout((()=>{m.classList.remove("error--visible")}),3500)},$=(e="search")=>{const o="search"===e?c:n;let s;o.innerHTML="","search"===e?s=t.searchJobItems.slice(7*t.currentPage-7,7*t.currentPage):"bookmarks"===e&&(s=t.bookmarkJobItems),s.forEach((e=>{const s=`\n        <li class="job-item ${t.activeJobItem.id===e.id?"job-item--active":""}">\n                <a class="job-item__link" href="${e.id}">\n                    <div class="job-item__badge">${e.badgeLetters}</div>\n                    <div class="job-item__middle">\n                        <h3 class="third-heading">${e.title}</h3>\n                        <p class="job-item__company">${e.company}</p>\n                        <div class="job-item__extras">\n                            <p class="job-item__extra"><i class="fa-solid fa-clock job-item__extra-icon"></i> ${e.duration}</p>\n                            <p class="job-item__extra"><i class="fa-solid fa-money-bill job-item__extra-icon"></i> ${e.salary}</p>\n                            <p class="job-item__extra"><i class="fa-solid fa-location-dot job-item__extra-icon"></i> ${e.location}</p>\n                        </div>\n                    </div>\n                    <div class="job-item__right">\n                        <i class="fa-solid fa-bookmark job-item__bookmark-icon ${t.bookmarkJobItems.some((t=>t.id===e.id))&&"job-item__bookmark-icon--bookmarked"}"></i>\n                        <time class="job-item__time">${e.daysAgo}d</time>\n                    </div>\n                </a>\n            </li>\n        `;o.insertAdjacentHTML("beforeend",s)}))},q=async o=>{o.preventDefault();const s=o.target.closest(".job-item");document.querySelectorAll(".job-item--active").forEach((e=>e.classList.remove("job-item--active"))),a.innerHTML="",y("job-details");const i=s.children[0].getAttribute("href"),n=[...t.searchJobItems,...t.bookmarkJobItems];t.activeJobItem=n.find((e=>e.id===+i)),$(),history.pushState(null,"",`/#${i}`);try{const t=await h(`${e}/jobs/${i}`),{jobItem:o}=t;y("job-details"),L(o)}catch(e){y("job-details"),I(e.message)}};c.addEventListener("click",q),n.addEventListener("click",q);const S=$;i.addEventListener("click",(e=>{e.target.className.includes("bookmark")&&(t.bookmarkJobItems.some((e=>e.id===t.activeJobItem.id))?t.bookmarkJobItems=t.bookmarkJobItems.filter((e=>e.id!==t.activeJobItem.id)):t.bookmarkJobItems.push(t.activeJobItem),localStorage.setItem("bookmarkJobItems",JSON.stringify(t.bookmarkJobItems)),document.querySelector(".job-info__bookmark-icon").classList.toggle("job-info__bookmark-icon--bookmarked"),S())})),o.addEventListener("mouseenter",(()=>{o.classList.add("bookmarks-btn--active"),n.classList.add("job-list--visible"),S("bookmarks")})),n.addEventListener("mouseleave",(()=>{o.classList.remove("bookmarks-btn--active"),n.classList.remove("job-list--visible")}));const J=()=>{t.currentPage>1?d.classList.remove("pagination__button--hidden"):d.classList.add("pagination__button--hidden"),t.searchJobItems.length-7*t.currentPage<=0?b.classList.add("pagination__button--hidden"):b.classList.remove("pagination__button--hidden"),_.textContent=t.currentPage++,_.textContent=t.currentPage--,b.blur(),d.blur()};l.addEventListener("click",(e=>{const o=e.target.closest(".pagination__button");o&&(o.className.includes("--next")?t.currentPage++:t.currentPage--,J(),S())}));const x=J,w=async()=>{const o=window.location.hash.substring(1);if(o){document.querySelectorAll(".job-item--active").forEach((e=>e.classList.remove("job-item--active"))),a.innerHTML="",y("job-details");try{const s=await h(`${e}/jobs/${o}`),{jobItem:a}=s;t.activeJobItem=a,S(),y("job-details"),L(a)}catch(e){y("job-details"),I(e.message)}}};window.addEventListener("DOMContentLoaded",w),window.addEventListener("hashchange",w),u.addEventListener("submit",(async o=>{o.preventDefault();const s=v.value;if(/[0-9]/.test(s))I("Your search may not contain numbers");else{v.blur(),c.innerHTML="",g.classList.remove("sorting__button--active"),f.classList.add("sorting__button--active"),y("search");try{const o=await h(`${e}/jobs?search=${s}`),{jobItems:a}=o;t.searchJobItems=a,t.currentPage=1,y("search"),r.textContent=a.length,x(),S()}catch(e){y("search"),I(e.message)}}})),k.addEventListener("click",(e=>{const o=e.target.closest(".sorting__button");if(!o)return;t.currentPage=1;const s=!!o.className.includes("--recent");s?(g.classList.add("sorting__button--active"),f.classList.remove("sorting__button--active")):(g.classList.remove("sorting__button--active"),f.classList.add("sorting__button--active")),s?t.searchJobItems.sort(((e,t)=>e.daysAgo-t.daysAgo)):t.searchJobItems.sort(((e,t)=>t.relevanceScore-e.relevanceScore)),x(),S()}));const E=localStorage.getItem("bookmarkJobItems");E&&(t.bookmarkJobItems=JSON.parse(E))})();